{%- if request.page_type == 'collection' -%}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": {{ collection.title | json }},
  "url": {{ shop.url | append: collection.url | json }},
  {%- if collection.description != blank -%}
    "description": {{ collection.description | strip_html | truncate: 5000 | json }},
  {%- endif -%}
  {%- if collection.image -%}
    "image": {{ collection.image | image_url: width: 1200 | prepend: 'https:' | json }},
  {%- endif -%}
  "numberOfItems": {{ collection.products_count | json }},
  "mainEntity": {
    "@type": "ItemList",
    "numberOfItems": {{ collection.products_count | json }},
    "itemListElement": [
      {%- for product in collection.products limit: 12 -%}
        {
          "@type": "ListItem",
          "position": {{ forloop.index }},
          "url": {{ shop.url | append: product.url | json }},
          "name": {{ product.title | json }}
        }{% unless forloop.last %},{% endunless %}
      {%- endfor -%}
    ]
  }
}
</script>
{%- endif -%}
